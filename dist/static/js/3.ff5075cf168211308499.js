webpackJsonp([3],{125:function(e,r,t){function o(e){t(285)}var n=t(41)(t(238),t(313),o,"data-v-91ce90d6",null);e.exports=n.exports},132:function(e,r){var t=e.exports={version:"2.5.0"};"number"==typeof __e&&(__e=t)},133:function(e,r,t){e.exports=!t(139)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},134:function(e,r){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},135:function(e,r){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},136:function(e,r,t){var o=t(141),n=t(149),i=t(146),s=Object.defineProperty;r.f=t(133)?Object.defineProperty:function(e,r,t){if(o(e),r=i(r,!0),o(t),n)try{return s(e,r,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[r]=t.value),e}},137:function(e,r,t){e.exports={default:t(138),__esModule:!0}},138:function(e,r,t){var o=t(132),n=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return n.stringify.apply(n,arguments)}},139:function(e,r){e.exports=function(e){try{return!!e()}catch(e){return!0}}},140:function(e,r,t){var o=t(136),n=t(142);e.exports=t(133)?function(e,r,t){return o.f(e,r,n(1,t))}:function(e,r,t){return e[r]=t,e}},141:function(e,r,t){var o=t(135);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},142:function(e,r){e.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}},143:function(e,r,t){var o=t(134),n=t(132),i=t(153),s=t(140),a=function(e,r,t){var l,c,u,d=e&a.F,p=e&a.G,f=e&a.S,m=e&a.P,v=e&a.B,g=e&a.W,h=p?n:n[r]||(n[r]={}),A=h.prototype,w=p?o:f?o[r]:(o[r]||{}).prototype;p&&(t=r);for(l in t)(c=!d&&w&&void 0!==w[l])&&l in h||(u=c?w[l]:t[l],h[l]=p&&"function"!=typeof w[l]?t[l]:v&&c?i(u,o):g&&w[l]==u?function(e){var r=function(r,t,o){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,t)}return new e(r,t,o)}return e.apply(this,arguments)};return r.prototype=e.prototype,r}(u):m&&"function"==typeof u?i(Function.call,u):u,m&&((h.virtual||(h.virtual={}))[l]=u,e&a.R&&A&&!A[l]&&s(A,l,u)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},146:function(e,r,t){var o=t(135);e.exports=function(e,r){if(!o(e))return e;var t,n;if(r&&"function"==typeof(t=e.toString)&&!o(n=t.call(e)))return n;if("function"==typeof(t=e.valueOf)&&!o(n=t.call(e)))return n;if(!r&&"function"==typeof(t=e.toString)&&!o(n=t.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},148:function(e,r,t){var o=t(135),n=t(134).document,i=o(n)&&o(n.createElement);e.exports=function(e){return i?n.createElement(e):{}}},149:function(e,r,t){e.exports=!t(133)&&!t(139)(function(){return 7!=Object.defineProperty(t(148)("div"),"a",{get:function(){return 7}}).a})},152:function(e,r){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},153:function(e,r,t){var o=t(152);e.exports=function(e,r,t){if(o(e),void 0===r)return e;switch(t){case 1:return function(t){return e.call(r,t)};case 2:return function(t,o){return e.call(r,t,o)};case 3:return function(t,o,n){return e.call(r,t,o,n)}}return function(){return e.apply(r,arguments)}}},156:function(e,r,t){e.exports={default:t(157),__esModule:!0}},157:function(e,r,t){t(170),e.exports=t(132).Number.isInteger},160:function(e,r,t){var o=t(135),n=Math.floor;e.exports=function(e){return!o(e)&&isFinite(e)&&n(e)===e}},170:function(e,r,t){var o=t(143);o(o.S,"Number",{isInteger:t(160)})},238:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t(137),n=t.n(o),i=t(156),s=t.n(i);r.default={data:function(){return{showDevices:!0,form:{names:[{text:""}]},AllowDevicesId:[],Devices:[],_data1:[],options:[],value5:[],ruleForm:{Firmwares:[{Index:1,UpgradeMode:"1",Firmware:""}],Version:"",Description:""},rules:{Index:[{validator:function(e,r,t){if(!r)return t(new Error("请输入升级编号"));setTimeout(function(){s()(r)?r<1?t(new Error("编号必须大于0")):t():t(new Error("请输入整数"))},500)},trigger:"blur"}]}}},mounted:function(){this.$nextTick(function(){this.listView(),this.listView2()})},computed:{DevicesId:{get:function(){var e=[];return this.Devices.forEach(function(r){e.push({DeviceId:r.DeviceId})}),e}},AllowDevices:{get:function(){var e=[];return this.AllowDevicesId.forEach(function(r){e.push({DeviceId:r})}),e}},DenyDevices:{get:function(){var e=[];this.Devices.forEach(function(r){e.push({DeviceId:r.DeviceId})});var r=[];this.AllowDevicesId.forEach(function(e){r.push({DeviceId:e})});for(var t=e.length-1;t>=0;t--)for(var o=e[t].DeviceId,n=r.length-1;n>=0;n--){var i=r[n].DeviceId;if(o===i){e.splice(t,1),r.splice(n,1);break}}return e}}},methods:{addModel:function(){this.ruleForm.Firmwares.push({Index:this.ruleForm.Firmwares.length+1,UpgradeMode:"1",Firmware:""}),console.log(this.ruleForm.Firmwares.length)},deleteModel:function(e,r){console.log(e);var t=this.ruleForm.Firmwares.length;this.ruleForm.Firmwares.splice(t-1,1)},listView:function(){var e=this,r=sessionStorage.getItem("productId"),t="/products/"+r+"/firmware",o=sessionStorage.getItem("login_TokenId")+t+"GET",n=this.md5(o)+","+sessionStorage.getItem("login_Signature");this.$http({url:"/iotadmin"+t,method:"GET",headers:{"content-type":"application/json","Rtt-Sign":n}}).then(function(r){console.log(r.data),e.options=r.data.Results,console.log(e.options)}).catch(function(e){return e.response?(console.log(e.response.data),console.log("222:"+e.response.status),console.log("333:"+e.response.header),(e.response.data.ErrCode="40000004")?void self.$message.error("网络错误，请稍后再试"):(self.$message.error("网络错误，请稍后再试"),!1)):(console.log(e),console.log("Error",e.message),!1)})},listView2:function(){var e=this,r=sessionStorage.getItem("productId"),t="/products/"+r+"/devices",o=sessionStorage.getItem("login_TokenId")+t+"GET",n=this.md5(o)+","+sessionStorage.getItem("login_Signature");this.$http({url:"/iotadmin"+t,method:"GET",headers:{"content-type":"application/json","Rtt-Sign":n}}).then(function(r){null==r.data.Results?e.showDevices=!1:(e.Devices=r.data.Results,e.showDevices=!0,console.log("Devices"),console.log(e.Devices))}).catch(function(e){return e.response?(e.response.data.ErrCode="40000004")?void self.$message.error("网络错误，请稍后再试"):(self.$message.error("网络错误，请稍后再试"),!1):(console.log(e),console.log("Error",e.message),!1)})},submitForm:function(e){var r=this,t=this.ruleForm.Firmwares,o=[];t.forEach(function(e){o.push({Index:e.Index,UpgradeMode:parseInt(e.UpgradeMode),Type:e.Firmware.Type,Version:e.Firmware.Version,Name:e.Firmware.Name,FileSize:e.Firmware.FileSize,FileUrl:e.Firmware.FileUrl,FileMd5:e.Firmware.FileMd5,FirmwareId:e.Firmware.FirmwareId,Description:e.Firmware.Description})}),console.log(o,"_data"),console.log(this.DevicesId,"DevicesId"),console.log(this.Devices,"Devices"),console.log(this.AllowDevices,"AllowDevices"),console.log(this.DenyDevices,"DenyDevices");var i=this,s=sessionStorage.getItem("productId"),a="/products/"+s+"/upgrade",l={Version:i.ruleForm.Version,Firmwares:o,AllowDevices:this.AllowDevices,DenyDevices:this.DenyDevices,Description:i.ruleForm.Description},c=n()(l),u=sessionStorage.getItem("login_TokenId")+a+"POST"+c,d=this.md5(u)+","+sessionStorage.getItem("login_Signature");console.log(c,"body"),console.log(a,"_url"),console.log(i.ruleForm),i.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;r.$http({url:"/iotadmin"+a,method:"POST",headers:{"content-type":"application/json","Rtt-Sign":d},data:c}).then(function(e){r.add_suc(e)}).catch(function(e){console.log("error:"+e),r.add_err(e)})})},add_suc:function(e){if(200==e.status){this.$notify({title:"GOOD",message:"新建OTA版本成功",type:"success"});var r=sessionStorage.getItem("productId"),t=sessionStorage.getItem("productName");console.log("productId:"+r),console.log("productName:"+t),this.$router.push({name:"upgradedList",params:{productId:r,productName:t}})}else this.$message.error("新建OTA版本失败")},add_err:function(e){var r=this;return e.response?(console.log(e.response.data),console.log(e.response.data.ErrCode),40000101!=e.response.data.ErrCode?(r.$message.error("添加新产品失败，请稍候再试"),!1):void r.$message.error("该产品已存在，请添加新产品")):(console.log("Error",e.message),r.$message.error("网络错误，请稍候再试"),!1)},escForm:function(e){this.$refs[e].resetFields(),this.$router.go(-1)}}}},261:function(e,r,t){r=e.exports=t(105)(!0),r.push([e.i,".ms-doc[data-v-91ce90d6]{width:100%;max-width:980px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif}.ms-doc h3[data-v-91ce90d6]{padding:9px 10px 10px;margin:0;font-size:14px;line-height:17px;background-color:#f5f5f5;border:1px solid #d8d8d8;border-bottom:0;border-radius:3px 3px 0 0}.ms-doc article[data-v-91ce90d6]{padding:45px;word-wrap:break-word;background-color:#fff;border:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.ms-doc article .el-input[data-v-91ce90d6]{width:300px}","",{version:3,sources:["C:/Users/Administrator/Desktop/realthread_IoT/vue_admin/src/views/upgraded/AddUpgraded.vue"],names:[],mappings:"AACA,yBACE,WAAY,AACZ,gBAAiB,AACjB,gFAAyF,CAC1F,AACD,4BACE,sBAAuB,AACvB,SAAU,AACV,eAAgB,AAChB,iBAAkB,AAClB,yBAA0B,AAC1B,yBAA0B,AAC1B,gBAAiB,AACjB,yBAA2B,CAC5B,AACD,iCACE,aAAc,AACd,qBAAsB,AACtB,sBAAuB,AACvB,sBAAuB,AACvB,+BAAgC,AAChC,6BAA+B,CAChC,AACD,2CACE,WAAa,CACd",file:"AddUpgraded.vue",sourcesContent:['\n.ms-doc[data-v-91ce90d6] {\n  width: 100%;\n  max-width: 980px;\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;\n}\n.ms-doc h3[data-v-91ce90d6] {\n  padding: 9px 10px 10px;\n  margin: 0;\n  font-size: 14px;\n  line-height: 17px;\n  background-color: #f5f5f5;\n  border: 1px solid #d8d8d8;\n  border-bottom: 0;\n  border-radius: 3px 3px 0 0;\n}\n.ms-doc article[data-v-91ce90d6] {\n  padding: 45px;\n  word-wrap: break-word;\n  background-color: #fff;\n  border: 1px solid #ddd;\n  border-bottom-right-radius: 3px;\n  border-bottom-left-radius: 3px;\n}\n.ms-doc article .el-input[data-v-91ce90d6] {\n  width: 300px;\n}\n'],sourceRoot:""}])},285:function(e,r,t){var o=t(261);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(106)("2ce468bb",o,!0)},313:function(e,r){e.exports={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("div",{staticClass:"ms-doc"},[t("h3",[e._v("新建OTA版本")]),e._v(" "),t("article",[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"版本号：",prop:"Version"}},[t("el-input",{attrs:{placeholder:"请输入版本号"},model:{value:e.ruleForm.Version,callback:function(r){e.ruleForm.Version=r},expression:"ruleForm.Version"}})],1),e._v(" "),e._l(e.ruleForm.Firmwares,function(r,o){return t("div",{key:o},[t("el-form-item",{attrs:{label:"选择固件"+r.Index,prop:"Firmwares."+o+".FirmwareId"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:r.Firmware,callback:function(e){r.Firmware=e},expression:"Firmware.Firmware"}},e._l(e.options,function(r){return t("el-option",{key:r.FirmwareId,attrs:{label:r.Type,value:r}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(r.Type))]),e._v(" "),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(r.Version))])])})),e._v(" "),o>0?t("el-button",{attrs:{type:"danger"},on:{click:function(r){e.deleteModel(o)}}},[e._v("删除模块")]):e._e(),e._v(" "),t("p",[e._v("下边是绑定的一个string： ")]),e._v(" "),t("p",{domProps:{textContent:e._s(r.Firmware)}})],1),e._v(" "),t("el-form-item",{attrs:{label:"升级模式",prop:"Firmwares."+o+".UpgradeMode"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:r.UpgradeMode,callback:function(e){r.UpgradeMode=e},expression:"Firmware.UpgradeMode"}},[t("el-option",{attrs:{label:"可选升级",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"强制升级",value:"2"}}),e._v(" "),t("el-option",{attrs:{label:"静默升级",value:"3"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"升级顺序编号：",prop:"Firmwares."+o+".Index"}},[t("el-input",{attrs:{placeholder:"请输入数字"},model:{value:r.Index,callback:function(t){r.Index=e._n(t)},expression:"Firmware.Index"}})],1)],1)}),e._v(" "),t("el-form-item",[t("el-button",{on:{click:e.addModel}},[e._v("新增模块")])],1),e._v(" "),t("el-form-item",{attrs:{label:"可升级设备列表："}},[e.showDevices?e._e():t("span",{staticStyle:{color:"#999"}},[e._v(" 请先添加设备")]),e._v(" "),e.showDevices?t("el-transfer",{attrs:{titles:["设备列表","可升级设备列表"],"button-texts":["移除","添加"],props:{key:"DeviceId",label:"SN"},data:e.Devices},model:{value:e.AllowDevicesId,callback:function(r){e.AllowDevicesId=r},expression:"AllowDevicesId"}}):e._e()],1),e._v(" "),t("el-form-item",{attrs:{label:"备注",prop:"Description"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.Description,callback:function(r){e.ruleForm.Description=r},expression:"ruleForm.Description"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),t("el-button",{on:{click:function(r){e.escForm("ruleForm")}}},[e._v("取消")])],1)],2)],1)])])},staticRenderFns:[]}}});
//# sourceMappingURL=3.ff5075cf168211308499.js.map