webpackJsonp([14],{117:function(e,t,o){function r(e){o(278)}var s=o(41)(o(230),o(306),r,"data-v-66209dac",null);e.exports=s.exports},132:function(e,t){var o=e.exports={version:"2.5.0"};"number"==typeof __e&&(__e=o)},137:function(e,t,o){e.exports={default:o(138),__esModule:!0}},138:function(e,t,o){var r=o(132),s=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}},230:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(137),s=o.n(r),a=o(16),n=o.n(a);t.default={data:function(){return{filters:{Name:""},tableData3:[{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-04",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-01",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-08",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-06",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-07",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"}],Results:[],showList:!1,addDevice:!1,updateDevice:!1,activeDevice:!1,listLoading:!1,deviceLog:!1,deviceShell:!1,ruleForm:{Name:"",Mac:"",desc:"",SN:""},ruleForm2:{Name:"",Mac:"",desc:"",SN:""},ruleForm3:{ProductKey:"",Name:"",Mac:"",desc:"",SN:""},rules:{SN:[{required:!0,message:"请输入设备序列号",trigger:"blur"}],ProductKey:[{required:!0,message:"请输入产品秘钥",trigger:"blur"}]}}},watch:{$route:"listView"},mounted:function(){this.$nextTick(function(){this.listView()})},methods:{selsChange:function(e){this.sels=e},handleCurrentChange:function(e){this.page=e,this.getUsers()},formatNum:function(e,t){return 1==e.IsActive?"是":0==e.IsActive?"否":"未知"},formatNum2:function(e,t){return 1==e.IsOnline?"是":0==e.IsOnline?"否":"未知"},formatTime:function(e,t){return null==e.OnlineDuration||""==e.OnlineDuration?"无":e.OnlineDuration+"  小时"},getUsers:function(){},listView:function(){var e=this,t=sessionStorage.getItem("productId"),o="/products/"+t+"/devices",r=sessionStorage.getItem("login_TokenId")+o+"GET",s=n()(r)+","+sessionStorage.getItem("login_Signature");console.log("sign",s),console.log("login_Signature",sessionStorage.getItem("login_Signature")),this.$http({url:"/iotadmin"+o,method:"GET",headers:{"content-type":"application/json","Rtt-Sign":s}}).then(function(t){null==t.data.Results?e.showList=!1:(e.productNum=!0,e.Results=t.data.Results,e.showList=!0)}).catch(function(e){return e.response?(e.response.data.ErrCode="40000004")?void self.$message.error("网络错误，请稍后再试"):(self.$message.error("网络错误，请稍后再试"),!1):(console.log(e),console.log("Error",e.message),!1)})},submitForm:function(e){var t=this,o=this,r=sessionStorage.getItem("productId"),a="/products/"+r+"/devices",i={SN:o.ruleForm.SN,Name:o.ruleForm.Name,Mac:o.ruleForm.Mac,Description:o.ruleForm.desc},l=s()(i),d=sessionStorage.getItem("login_TokenId")+a+"POST"+l,c=n()(d)+","+sessionStorage.getItem("login_Signature");o.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log(0),t.$http({url:"/iotadmin"+a,method:"POST",headers:{"content-type":"application/json","Rtt-Sign":c},data:l},l).then(function(e){console.log("res:"+e),t.add_suc(e)}).catch(function(e){console.log("error:"+e),t.add_err(e)})})},add_suc:function(e){console.log(55555),200==e.status?(this.$notify({title:"GOOD",message:"新建设备成功",type:"success"}),this.$refs.ruleForm.resetFields(),this.addDevice=!1,this.listView()):this.$message.error("新建设备失败")},add_err:function(e){var t=this;if(console.log(5555555555),!e.response)return console.log("Error",e.message),t.$message.error("网络错误，请稍候再试"),this.$refs.ruleForm.resetFields(),this.addDevice=!1,!1;if(console.log(e.response.data),console.log(e.response.data.ErrCode),40000201==e.response.data.ErrCode)t.$message.error("该设备名已存在，请勿重复添加");else if(40000203==e.response.data.ErrCode)t.$message.error("该设备MAC地址已存在，请勿重复添加");else if(40000204==e.response.data.ErrCode)t.$message.error("该设备序列号已存在，请勿重复添加");else{if(50000002!=e.response.data.ErrCode)return this.$refs.ruleForm.resetFields(),this.addDevice=!1,t.$message.error("网络错误，请稍候再试"),!1;t.$message.error("设备序列号最长不能超过32位")}},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该产品信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var o=t,r=sessionStorage.getItem("productId"),s="/products/"+r+"/devices/"+e,a=sessionStorage.getItem("login_TokenId")+s+"DELETE",i=n()(a)+","+sessionStorage.getItem("login_Signature");console.log(a),console.log(i),t.$http({url:"/iotadmin"+s,method:"DELETE",headers:{"content-type":"application/json","Rtt-Sign":i}}).then(function(e){console.log(e.data),""==e.data?(t.$message({type:"success",message:"删除成功!"}),t.listView()):(t.$message({type:"info",message:"删除失败"}),t.listView()),t.information=e.data}).catch(function(e){return e.response?(console.log(e.response.data),console.log("222:"+e.response.status),console.log("333:"+e.response.header),(e.response.data.ErrCode="40000004")?(o.$message.error("网络错误，请稍后再试"),void this.listView()):(o.$message.error("网络错误，请稍后再试"),this.listView(),!1)):(console.log(e),console.log("Error",e.message),this.listView(),!1)})}).catch(function(){t.$message({type:"info",message:"已取消删除"}),t.listView()})},handleEdit:function(e){console.log(e);var t=this;t.ruleForm2={SN:e.SN,Name:e.Name,Mac:e.Mac,DeviceId:e.DeviceId},sessionStorage.setItem("DeviceId",e.DeviceId),t.updateDevice=!0},handleLog:function(e){console.log(e);var t=this;sessionStorage.setItem("DeviceId",e.DeviceId),t.deviceLog=!0},handleShell:function(e){console.log(e);var t=this;sessionStorage.setItem("DeviceId",e.DeviceId),t.deviceShell=!0},submitForm2:function(e){var t=this,o=this,r=sessionStorage.getItem("productId"),a=sessionStorage.getItem("DeviceId"),i="/products/"+r+"/devices/"+a,l={SN:o.ruleForm2.SN,Name:o.ruleForm2.Name,Mac:o.ruleForm2.Mac,Description:o.ruleForm2.desc},d=s()(l),c=sessionStorage.getItem("login_TokenId")+i+"PUT"+d,u=n()(c)+","+sessionStorage.getItem("login_Signature");o.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log(d),t.$http({url:"/iotadmin"+i,method:"PUT",headers:{"content-type":"application/json","Rtt-Sign":u},data:d}).then(function(e){t.add_suc2(e)}).catch(function(e){console.log("error:"+e),t.add_err2(e)})})},add_suc2:function(e){if(200==e.status){this.$notify({title:"GOOD",message:"更新设备信息成功",type:"success"});var t=sessionStorage.getItem("productId");console.log("newId:"+t),this.updateDevice=!1,this.listView()}else this.$message.error("更新设备信息失败")},add_err2:function(e){var t=this;return e.response?(console.log(e.response.data),console.log(e.response.data.ErrCode),40000101!=e.response.data.ErrCode?(t.$message.error("更新数据失败，请稍候再试"),!1):void t.$message.error("更新数据失败，请稍候再试")):(console.log("Error",e.message),t.$message.error("网络错误，请稍候再试"),!1)},handleDetail:function(e){sessionStorage.setItem("deviceId",e);var t=e;console.log("newId"+t),this.$router.push({name:"deviceDetail",params:{productId:t}})},formatter:function(e,t){return e.address}}}},254:function(e,t,o){t=e.exports=o(105)(!0),t.push([e.i,".ms-doc[data-v-66209dac]{width:100%;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif}.ms-doc h3[data-v-66209dac]{padding:9px 10px 10px;margin:0;font-size:14px;line-height:25px;background-color:#f5f5f5;border:1px solid #d8d8d8;border-bottom:0;border-radius:3px 3px 0 0}.ms-doc article[data-v-66209dac]{padding:45px;word-wrap:break-word;background-color:#fff;border:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.ms-doc article>div[data-v-66209dac]{padding:10px 0}.el-dialog[data-v-66209dac]{min-height:300px}th.el-table_1_column_6>.cell[data-v-66209dac]{width:220px}","",{version:3,sources:["C:/Users/Administrator/Desktop/realthread_IoT/vue_admin/src/views/device/DeviceList.vue"],names:[],mappings:"AACA,yBACE,WAAY,AACZ,gFAAyF,CAC1F,AACD,4BACE,sBAAuB,AACvB,SAAU,AACV,eAAgB,AAChB,iBAAkB,AAClB,yBAA0B,AAC1B,yBAA0B,AAC1B,gBAAiB,AACjB,yBAA2B,CAC5B,AACD,iCACE,aAAc,AACd,qBAAsB,AACtB,sBAAuB,AACvB,sBAAuB,AACvB,+BAAgC,AAChC,6BAA+B,CAChC,AACD,qCACE,cAAgB,CACjB,AACD,4BACE,gBAAkB,CACnB,AACD,8CACE,WAAa,CACd",file:"DeviceList.vue",sourcesContent:['\n.ms-doc[data-v-66209dac] {\n  width: 100%;\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;\n}\n.ms-doc h3[data-v-66209dac] {\n  padding: 9px 10px 10px;\n  margin: 0;\n  font-size: 14px;\n  line-height: 25px;\n  background-color: #f5f5f5;\n  border: 1px solid #d8d8d8;\n  border-bottom: 0;\n  border-radius: 3px 3px 0 0;\n}\n.ms-doc article[data-v-66209dac] {\n  padding: 45px;\n  word-wrap: break-word;\n  background-color: #fff;\n  border: 1px solid #ddd;\n  border-bottom-right-radius: 3px;\n  border-bottom-left-radius: 3px;\n}\n.ms-doc article > div[data-v-66209dac] {\n  padding: 10px 0;\n}\n.el-dialog[data-v-66209dac]{\n  min-height: 300px;\n}\nth.el-table_1_column_6>.cell[data-v-66209dac]{\n  width: 220px;\n}\n'],sourceRoot:""}])},278:function(e,t,o){var r=o(254);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o(106)("8b0413b8",r,!0)},306:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"ms-doc"},[o("h3",{staticClass:"clearfix header"},[e._v("\n      设备列表\n      "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){e.addDevice=!0}}},[e._v("+ 新建设备")])],1),e._v(" "),o("el-dialog",{attrs:{title:"新建设备",visible:e.addDevice},on:{"update:visible":function(t){e.addDevice=t}}},[o("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[o("el-form-item",{attrs:{label:"设备序列号(SN)",prop:"SN"}},[o("el-input",{attrs:{placeholder:"设备序列号最长不能超过32位"},model:{value:e.ruleForm.SN,callback:function(t){e.ruleForm.SN=t},expression:"ruleForm.SN"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"设备名称",prop:"Name"}},[o("el-input",{model:{value:e.ruleForm.Name,callback:function(t){e.ruleForm.Name=t},expression:"ruleForm.Name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"MAC地址：",prop:"Mac"}},[o("el-input",{model:{value:e.ruleForm.Mac,callback:function(t){e.ruleForm.Mac=t},expression:"ruleForm.Mac"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"描述：",prop:"desc"}},[e._v("*\n          "),o("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.desc,callback:function(t){e.ruleForm.desc=t},expression:"ruleForm.desc"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",slot:"footer"},[o("el-button",{on:{click:function(t){e.addDevice=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("确 定")])],1)],1),e._v(" "),o("article",[e.showList?e._e():o("span",{staticStyle:{color:"#999"}},[e._v("暂无设备")]),e._v(" "),e.showList?o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"table",attrs:{data:e.Results,border:"","highlight-current-row":"","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.selsChange}},[o("el-table-column",{attrs:{prop:"DeviceId",label:"设备ID",sortable:"",align:"center",width:"170"}}),e._v(" "),o("el-table-column",{attrs:{prop:"SN",label:"设备序列号(SN)",align:"center",width:"150"}}),e._v(" "),o("el-table-column",{attrs:{prop:"Name",label:"设备名称",align:"center",width:"110"}}),e._v(" "),o("el-table-column",{attrs:{prop:"Mac",label:"MAC地址",align:"center",width:"180"}}),e._v(" "),o("el-table-column",{attrs:{prop:"IsOnline",formatter:e.formatNum2,label:"是否在线",align:"center",width:"110"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"small",type:"info"},on:{click:function(o){e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(o){e.handleDelete(t.row.DeviceId)}}},[e._v("删除")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(o){e.handleDetail(t.row.DeviceId)}}},[e._v("详情")])]}}])})],1):e._e()],1),e._v(" "),o("el-dialog",{attrs:{title:"更新设备信息",visible:e.updateDevice},on:{"update:visible":function(t){e.updateDevice=t}}},[o("el-form",{ref:"ruleForm2",attrs:{model:e.ruleForm2,rules:e.rules}},[o("el-form-item",{attrs:{label:"设备序列号(SN)",prop:"SN"}},[o("el-input",{attrs:{readonly:""},model:{value:e.ruleForm2.SN,callback:function(t){e.ruleForm2.SN=t},expression:"ruleForm2.SN"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"设备名称",prop:"Name"}},[o("el-input",{model:{value:e.ruleForm2.Name,callback:function(t){e.ruleForm2.Name=t},expression:"ruleForm2.Name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"MAC地址：",prop:"Mac"}},[o("el-input",{model:{value:e.ruleForm2.Mac,callback:function(t){e.ruleForm2.Mac=t},expression:"ruleForm2.Mac"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"描述：",prop:"desc"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm2.desc,callback:function(t){e.ruleForm2.desc=t},expression:"ruleForm2.desc"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",slot:"footer"},[o("el-button",{on:{click:function(t){e.updateDevice=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm2("ruleForm2")}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"设备日志",visible:e.deviceLog},on:{"update:visible":function(t){e.deviceLog=t}}},[[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData3,height:"250",border:""}},[o("el-table-column",{attrs:{prop:"date",label:"时间",width:"180"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"问题",width:"180"}}),e._v(" "),o("el-table-column",{attrs:{prop:"address",label:"描述"}})],1)],e._v(" "),o("div",{staticClass:"dialog-footer",slot:"footer"},[o("el-button",{on:{click:function(t){e.deviceLog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){}}},[e._v("更新")])],1)],2)],1)])},staticRenderFns:[]}}});
//# sourceMappingURL=14.68e0a52ad9c14c5240a9.js.map